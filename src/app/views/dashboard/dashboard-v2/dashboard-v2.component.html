<div *ngIf="userName === 'admin';">
  <div class="breadcrumb">
  <ul>
    <li><a href="">TABLEAU DE BORD</a></li>
    <li>DISTRICO SENEGAL</li>
  </ul>
</div>
<div class="separator-breadcrumb border-top"></div>

<!-- ===================== SECTION FILTRES ===================== -->
<div class="card mb-4 shadow-sm">
  <div class="card-body">
    <h5 class="mb-3 text-primary text-uppercase">
      Rapport de production par client
    </h5>

    <div class="row g-3 align-items-end">
      <!-- Sélection du client -->
      <div class="col-md-4">
        <label for="client" class="form-label fw-semibold">Client</label>
        <select
          class="form-select"
          [(ngModel)]="clienselectione"
          id="client"
          (change)="onFiltreChange()"
        >
          <option [ngValue]="null" selected>-- Sélectionner un client --</option>
          <option *ngFor="let client of Clients" [value]="client.id">
            {{ client.nom }} {{ client.prenom }}
          </option>
        </select>
      </div>

      <!-- Date début -->
      <div class="col-md-3">
        <label for="dateDebut" class="form-label fw-semibold">Date de début</label>
        <input
          type="date"
          class="form-control"
          [(ngModel)]="dateDebut"
          id="dateDebut"
          (change)="onFiltreChange()"
        />
      </div>

      <!-- Date fin -->
      <div class="col-md-3">
        <label for="dateFin" class="form-label fw-semibold">Date de fin</label>
        <input
          type="date"
          class="form-control"
          [(ngModel)]="dateFin"
          id="dateFin"
          (change)="onFiltreChange()"
        />
      </div>

      <!-- Bouton PDF -->
      <div class="col-md-2 d-flex justify-content-end">
        <button
          class="btn btn-primary w-100"
          [disabled]="!clienselectione"
          (click)="telechargerRapport()"
        >
          <i class="bi bi-file-earmark-pdf"></i> Télécharger PDF
        </button>
      </div>
    </div>

    <!-- Filtre statut -->
    <div class="row mt-3">
      <div class="col-md-4">
        <label for="statut" class="form-label fw-semibold">Statut</label>
        <select
          class="form-select"
          [(ngModel)]="statutFiltre"
          id="statut"
          (change)="onFiltreChange()"
        >
          <option [ngValue]="null" selected>-- Tous les statuts --</option>
          <option value="en_attente">En attente</option>
          <option value="en_cours">En cours</option>
          <option value="livree">Livrée</option>
          <option value="annulee">Annulée</option>
        </select>
      </div>
    </div>

    <!-- Résumé des filtres -->
    <div *ngIf="aFiltresActifs()" class="alert alert-info mt-3 py-2">
      <small>
        <strong>Filtres actifs :</strong>
        <span *ngIf="dateDebut || dateFin">
          Période : {{ dateDebut || 'Début' }} → {{ dateFin || 'Fin' }}
        </span>
        <span *ngIf="statutFiltre">
          | Statut : {{ getLibelleStatut(statutFiltre) }}
        </span>
      </small>
    </div>
  </div>
</div>

<div class="row mt-3" *ngIf="chartOptions">
  <div class="col-lg-12">
    <div class="card shadow-sm">
      <div class="card-body">
        <h4 class="text-center mb-3 text-primary">
          Rapport de production du client
        </h4>

        <apx-chart
          #chart
          [series]="chartOptions.series"
          [chart]="chartOptions.chart"
          [xaxis]="chartOptions.xaxis"
          [yaxis]="chartOptions.yaxis"
          [colors]="chartOptions.colors"
          [dataLabels]="chartOptions.dataLabels"
          [legend]="chartOptions.legend"
          [title]="chartOptions.title"
          [plotOptions]="chartOptions.plotOptions"
          [fill]="chartOptions.fill"
          [stroke]="chartOptions.stroke"
        ></apx-chart>
      </div>
    </div>
  </div>
</div>

</div>
